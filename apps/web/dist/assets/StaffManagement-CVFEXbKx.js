import{r as l,s as o,j as e}from"./index-BYf_M4te.js";import{l as dt,a as ot,b as xt,c as mt,d as ut,e as ht,f as pt,g as gt,m as ft,h as jt,u as be,i as yt,j as bt,k as vt,n as Nt,o as wt,s as _t,p as At,q as St}from"./PrincipalDashboard-DJEDWxuL.js";import{T as kt}from"./TeacherPaymentHistory-_gbXKPHO.js";import"./auth.service-Cd_ACuOs.js";import"./UnpaidFeeAnalytics-B19wVUyc.js";import"./clerk.service-Bny41jb4.js";function Et(){const v=l.useRef(!0),[q,ve]=l.useState([]),[Ne,V]=l.useState(!0),[se,$]=l.useState(null),[ae,we]=l.useState([]),[_e,Ae]=l.useState([]),[ne,H]=l.useState({}),[Y,Se]=l.useState([]),[E,ke]=l.useState(""),[F,Ce]=l.useState("all"),[P,De]=l.useState("all"),[Te,j]=l.useState({}),[Me,B]=l.useState(!1),[Oe,G]=l.useState(!1),[U,le]=l.useState(!1),[$e,re]=l.useState(!1),[Ee,W]=l.useState(!1),[ie,Q]=l.useState(!1),[Fe,ce]=l.useState(!1),[n,m]=l.useState(null),[x,L]=l.useState({teacher_id:"",class_group_id:"",subject_id:"",section_id:""}),[_,J]=l.useState({date:new Date().toISOString().split("T")[0],status:"present",notes:""}),[u,Pe]=l.useState(new Date().getMonth()+1),[h,Le]=l.useState(new Date().getFullYear()),[de,oe]=l.useState({}),[k,xe]=l.useState({totalDays:0,presentDays:0,absentDays:0}),[K,me]=l.useState(!1),[y,C]=l.useState({full_name:"",email:"",phone:"",approval_status:"approved"}),[ue,Re]=l.useState([]),[D,ze]=l.useState(null),[p,Ie]=l.useState(null),[he,qe]=l.useState([]),[R,pe]=l.useState([]),[Ve,X]=l.useState(!1),[g,Z]=l.useState({teacher_id:"",class_group_id:"",section_id:""}),[He,ee]=l.useState(!1),[d,b]=l.useState({email:"",password:"",full_name:"",role:"teacher",phone:"",gender:"",salary_start_date:""});l.useEffect(()=>(v.current=!0,O(),Ye(),Be(),T(),M(),()=>{v.current=!1}),[]);const Ye=async()=>{var t;try{const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;const a=await dt(s);we(a.classes||[])}catch(s){console.error("Error loading classes:",s)}},Be=async()=>{var t;try{const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;const a=await ot(s);Ae(a.subjects||[])}catch(s){console.error("Error loading subjects:",s)}},T=async()=>{var t;try{const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;const a=await xt(s);Se(a.assignments||[])}catch(s){console.error("Error loading assignments:",s)}},M=async()=>{var t;try{const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;const a=await mt(s);pe(a.assignments||[])}catch(s){console.error("Error loading attendance assignments:",s)}},z=l.useCallback(async t=>{if(!t){H(s=>({...s,[t]:[]}));return}H(s=>(s[t]||(async()=>{var a;try{const i=(a=(await o.auth.getSession()).data.session)==null?void 0:a.access_token;if(!i)return;const c=await ut(i,t);H(r=>({...r,[t]:c.sections||[]}))}catch(i){console.error("Error loading sections:",i)}})(),s))},[]),O=async()=>{var t;try{$(null),V(!0);const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s){$("No authentication token found. Please log in again."),V(!1);return}const i=((await ht(s)).staff||[]).map(c=>{const r=c.profile||c;return{...r,created_at:c.created_at||r.created_at}});ve(i)}catch(s){console.error("Error loading staff:",s),$(s.message||"Failed to load staff. Please try again.")}finally{V(!1)}},Ge=t=>{m(t),L({teacher_id:t.id,class_group_id:"",subject_id:"",section_id:""}),B(!0)},Ue=t=>{m(t),Z({teacher_id:t.id,class_group_id:"",section_id:""}),X(!0)},We=async t=>{var s;m(t);try{const a=(s=(await o.auth.getSession()).data.session)==null?void 0:s.access_token;if(!a)return;const i=await St(a,t.id);Re(i.attendance||[]),ze(i.summary||null),G(!0)}catch(a){console.error("Error loading attendance:",a)}},Qe=async()=>{var t;if(n)try{const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;await ft(s,{teacher_id:n.id,..._}),alert("Attendance marked successfully!"),G(!1),We(n)}catch(s){alert(s.message||"Failed to mark attendance")}},Je=async t=>{var s;m(t);try{const a=(s=(await o.auth.getSession()).data.session)==null?void 0:s.access_token;if(!a)return;const i=await jt(a,t.id);Ie(i),re(!0)}catch(a){console.error("Error loading performance:",a)}},Ke=t=>{m(t),C({full_name:t.full_name||"",email:t.email||"",phone:t.phone||"",approval_status:t.approval_status==="approved"?"approved":"rejected"}),W(!0)},Xe=async()=>{var t;if(n)try{const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;await be(s,n.id,y),alert("Teacher updated successfully!"),W(!1),O()}catch(s){alert(s.message||"Failed to update teacher")}},Ze=async t=>{var s;if(confirm(`Are you sure you want to ${t.approval_status==="approved"?"deactivate":"activate"} ${t.full_name}?`))try{const a=(s=(await o.auth.getSession()).data.session)==null?void 0:s.access_token;if(!a)return;await be(a,t.id,{approval_status:t.approval_status==="approved"?"rejected":"approved"}),alert(`Teacher ${t.approval_status==="approved"?"deactivated":"activated"} successfully!`),O()}catch(a){alert(a.message||"Failed to update teacher")}},te=async t=>{var s;m(t);try{const a=(s=(await o.auth.getSession()).data.session)==null?void 0:s.access_token;if(!a)return;const[i,c]=await Promise.all([yt(a,t.id),bt(a,t.id)]);qe(i.assignments||[]),pe(r=>[...r.filter(N=>N.teacher_id!==t.id),...c.assignments||[]]),Q(!0)}catch(a){console.error("Error loading assignments:",a)}},et=async()=>{var t;if(!x.teacher_id||!x.class_group_id||!x.subject_id){alert("Please fill in all required fields");return}try{const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;await vt(s,x),alert("Teaching assignment created successfully!"),B(!1),T()}catch(s){alert(s.message||"Failed to create assignment")}},tt=async()=>{var t;if(!g.teacher_id||!g.class_group_id){alert("Please select a class");return}try{const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;await Nt(s,{teacher_id:g.teacher_id,class_group_id:g.class_group_id,section_id:g.section_id||null}),alert("Attendance assignment created successfully! Teacher can now mark attendance for this class."),X(!1),M()}catch(s){alert(s.message||"Failed to create attendance assignment")}},st=async t=>{var s;if(confirm("Are you sure you want to remove this assignment?"))try{const a=(s=(await o.auth.getSession()).data.session)==null?void 0:s.access_token;if(!a)return;await wt(a,t),alert("Assignment removed successfully!"),T(),ie&&te(n)}catch(a){alert(a.message||"Failed to delete assignment")}};l.useEffect(()=>(x.class_group_id&&z(x.class_group_id),()=>{}),[x.class_group_id,z]);const ge=t=>Y.filter(s=>s.teacher_id===t).length,A=l.useCallback(async(t,s,a)=>{var i;try{const c=(i=(await o.auth.getSession()).data.session)==null?void 0:i.access_token;if(!c||!v.current)return;const r=new Date(a,s-1,1),f=new Date(a,s,0),N=await pt(c,t,r.toISOString().split("T")[0],f.toISOString().split("T")[0]);if(!v.current||!v.current)return;const S={},fe=f.getDate();for(let w=1;w<=fe;w++){const ct=new Date(a,s-1,w).toISOString().split("T")[0];S[ct]="present"}if((N.attendance||[]).forEach(w=>{w.status==="absent"&&(S[w.date]="absent")}),!v.current)return;oe(S);const je=fe,ye=Object.values(S).filter(w=>w==="absent").length,it=je-ye;v.current&&xe({totalDays:je,presentDays:it,absentDays:ye})}catch(c){v.current&&console.error("Error loading daily attendance:",c)}},[]);l.useEffect(()=>(U&&n&&A(n.id,u,h),()=>{}),[U,n,A,u,h]);const at=t=>{oe(s=>{const a={...s};a[t]=s[t]==="absent"?"present":"absent";const i=Object.values(a).filter(r=>r==="absent").length,c=k.totalDays-i;return xe({totalDays:k.totalDays,presentDays:c,absentDays:i}),a})},nt=async()=>{var t;if(n)try{me(!0);const s=(t=(await o.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;const a=new Date(h,u-1,1),i=new Date(h,u,0),c=Object.entries(de).filter(([r,f])=>f==="absent").map(([r])=>r);await _t(s,{teacher_id:n.id,start_date:a.toISOString().split("T")[0],end_date:i.toISOString().split("T")[0],absent_dates:c}),alert("Attendance saved successfully!"),A(n.id,u,h)}catch(s){alert(s.message||"Failed to save attendance")}finally{me(!1)}};if(l.useEffect(()=>{const t=()=>{j({})};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]),Ne)return e.jsx("div",{className:"p-6",children:"Loading staff..."});if(se)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-red-600 text-xl mr-2",children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-red-800 font-semibold",children:"Error Loading Staff"}),e.jsx("p",{className:"text-red-600 text-sm mt-1",children:se})]})]}),e.jsx("button",{onClick:()=>{$(null),O()},className:"mt-3 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Retry"})]})});const lt=async t=>{var s;t.preventDefault();try{const a=(s=(await o.auth.getSession()).data.session)==null?void 0:s.access_token;if(!a)return;await At(a,{email:d.email,password:d.password,full_name:d.full_name,role:d.role,phone:d.phone||null,gender:d.gender||null,salary_start_date:d.role==="teacher"&&d.salary_start_date?d.salary_start_date:null}),alert(`${d.role==="clerk"?"Clerk":"Teacher"} added successfully!`),ee(!1),b({email:"",password:"",full_name:"",role:"teacher",phone:"",gender:"",salary_start_date:""}),O()}catch(a){alert(a.message||"Failed to add staff member")}},I=q.filter(t=>{const s=t.full_name??"",a=t.email??"",i=(t.role??"").toLowerCase(),c=(t.approval_status??"approved").toLowerCase(),r=s.toLowerCase().includes(E.toLowerCase())||a.toLowerCase().includes(E.toLowerCase()),f=F==="all"||i===F.toLowerCase(),N=P==="all"||c===P.toLowerCase();return r&&f&&N}),rt=(t,s)=>{j(a=>({...a,[t]:!a[t]}))};return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Staff Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your school staff members and their assignments"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{Q(!0),m(null),T(),M()},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition flex items-center gap-2 shadow-sm",children:[e.jsx("span",{children:"ðŸ“‹"}),e.jsx("span",{className:"hidden sm:inline",children:"View All Assignments"}),e.jsx("span",{className:"sm:hidden",children:"Assignments"})]}),e.jsxs("button",{onClick:()=>ee(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition flex items-center gap-2 shadow-sm font-semibold",children:[e.jsx("span",{children:"âž•"}),e.jsx("span",{children:"Add Staff"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:E,onChange:t=>ke(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"absolute left-3 top-2.5 text-gray-400",children:"ðŸ”"})]}),e.jsxs("select",{value:F,onChange:t=>Ce(t.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"teacher",children:"Teachers"}),e.jsx("option",{value:"clerk",children:"Clerks"})]}),e.jsxs("select",{value:P,onChange:t=>De(t.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),I.length!==q.length&&e.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Showing ",I.length," of ",q.length," staff members"]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Staff Member"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Role & Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Assignments"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-6xl mb-4",children:"ðŸ‘¥"}),e.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"No staff members found"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:E||F!=="all"||P!=="all"?"Try adjusting your filters":"Add your first staff member to get started"})]})})}):I.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center text-white font-semibold text-lg",children:((s=t.full_name)==null?void 0:s.charAt(0).toUpperCase())||"?"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:t.full_name||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:t.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800 w-fit",children:t.role}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold w-fit ${t.approval_status==="approved"?"bg-green-100 text-green-800":t.approval_status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.approval_status})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:ge(t.id)}),e.jsx("span",{className:"text-sm text-gray-500",children:ge(t.id)===1?"assignment":"assignments"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(t.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsxs("button",{onClick:a=>{a.stopPropagation(),rt(t.id)},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition",children:[e.jsx("span",{children:"Actions"}),e.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Te[t.id]&&e.jsx("div",{className:"absolute right-0 mt-2 w-64 rounded-lg shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50",onClick:a=>a.stopPropagation(),children:e.jsxs("div",{className:"py-1",children:[t.role==="teacher"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{Ge(t),j({})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“š"}),e.jsx("span",{children:"Assign Teaching"})]}),e.jsxs("button",{onClick:()=>{Ue(t),j({})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-teal-50 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“…"}),e.jsx("span",{children:"Assign Attendance Class"})]}),e.jsxs("button",{onClick:()=>{m(t),le(!0),A(t.id,u,h),j({})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-green-50 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‘¤"}),e.jsx("span",{children:"Mark Attendance"})]}),e.jsxs("button",{onClick:()=>{Je(t),j({})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“Š"}),e.jsx("span",{children:"View Performance"})]}),e.jsxs("button",{onClick:()=>{te(t),j({})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-indigo-50 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‘ï¸"}),e.jsx("span",{children:"View All Assignments"})]}),e.jsxs("button",{onClick:()=>{m(t),ce(!0),j({})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-emerald-50 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ’°"}),e.jsx("span",{children:"Payment History"})]}),e.jsx("div",{className:"border-t border-gray-200 my-1"})]}),e.jsxs("button",{onClick:()=>{Ke(t),j({})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-orange-50 flex items-center gap-2",children:[e.jsx("span",{children:"âœï¸"}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:()=>{Ze(t),j({})},className:`w-full text-left px-4 py-2 text-sm flex items-center gap-2 ${t.approval_status==="approved"?"text-red-700 hover:bg-red-50":"text-green-700 hover:bg-green-50"}`,children:[e.jsx("span",{children:t.approval_status==="approved"?"ðŸš«":"âœ…"}),e.jsx("span",{children:t.approval_status==="approved"?"Deactivate":"Activate"})]})]})})]})})]},t.id)})})]})})}),Me&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Teaching Assignment: ",n.full_name]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Assign teacher to teach a specific subject in a class. This is separate from attendance responsibilities."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Class *"}),e.jsxs("select",{value:x.class_group_id,onChange:t=>{L({...x,class_group_id:t.target.value,section_id:""}),t.target.value&&z(t.target.value)},className:"w-full px-3 py-2 border rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Class"}),ae.map(t=>{const s=t.classifications&&t.classifications.length>0?` (${t.classifications.map(a=>`${a.type}: ${a.value}`).join(", ")})`:"";return e.jsxs("option",{value:t.id,children:[t.name,s]},t.id)})]})]}),x.class_group_id&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Section (Optional)"}),e.jsxs("select",{value:x.section_id,onChange:t=>L({...x,section_id:t.target.value}),className:"w-full px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"",children:"No Section"}),(ne[x.class_group_id]||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subject *"}),e.jsxs("select",{value:x.subject_id,onChange:t=>L({...x,subject_id:t.target.value}),className:"w-full px-3 py-2 border rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Subject"}),_e.map(t=>e.jsxs("option",{value:t.id,children:[t.name," ",t.code?`(${t.code})`:""]},t.id))]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:et,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Assign"}),e.jsx("button",{onClick:()=>B(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})}),Oe&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold",children:["Teacher Attendance: ",n.full_name]}),e.jsx("button",{onClick:()=>G(!1),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),D&&e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Days"}),e.jsx("p",{className:"text-2xl font-bold",children:D.totalDays})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Present"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:D.presentDays})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Absent"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:D.absentDays})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Percentage"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[D.attendancePercentage,"%"]})]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Mark Attendance for Today"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date"}),e.jsx("input",{type:"date",value:_.date,onChange:t=>J({..._,date:t.target.value}),className:"w-full px-3 py-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:_.status,onChange:t=>J({..._,status:t.target.value}),className:"w-full px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"present",children:"Present"}),e.jsx("option",{value:"absent",children:"Absent"}),e.jsx("option",{value:"late",children:"Late"}),e.jsx("option",{value:"leave",children:"Leave"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes (Optional)"}),e.jsx("input",{type:"text",value:_.notes,onChange:t=>J({..._,notes:t.target.value}),className:"w-full px-3 py-2 border rounded-md",placeholder:"Add notes..."})]})]}),e.jsx("button",{onClick:Qe,className:"mt-3 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"Mark Attendance"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Notes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ue.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.status==="present"?"bg-green-100 text-green-800":t.status==="late"?"bg-yellow-100 text-yellow-800":t.status==="leave"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:t.status})}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:t.notes||"-"})]},t.id))})]}),ue.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No attendance records yet."})]})]})}),$e&&n&&p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold",children:["Performance: ",n.full_name]}),e.jsx("button",{onClick:()=>re(!1),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Attendance Metrics"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Days:"}),e.jsx("span",{className:"font-bold",children:p.attendance.totalDays})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Present:"}),e.jsx("span",{className:"font-bold text-green-600",children:p.attendance.presentDays})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Absent:"}),e.jsx("span",{className:"font-bold text-red-600",children:p.attendance.absentDays})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Late:"}),e.jsx("span",{className:"font-bold text-yellow-600",children:p.attendance.lateDays})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Leave:"}),e.jsx("span",{className:"font-bold text-blue-600",children:p.attendance.leaveDays})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 mt-2",children:[e.jsx("span",{children:"Attendance %:"}),e.jsxs("span",{className:"font-bold text-purple-600",children:[p.attendance.attendancePercentage,"%"]})]})]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Marks Metrics"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Marks Entered:"}),e.jsx("span",{className:"font-bold",children:p.marks.totalEntered})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Verified:"}),e.jsx("span",{className:"font-bold text-green-600",children:p.marks.verified})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 mt-2",children:[e.jsx("span",{children:"Verification Rate:"}),e.jsxs("span",{className:"font-bold text-purple-600",children:[p.marks.verificationRate,"%"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Recent Attendance Records"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.attendance.recentRecords.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.status==="present"?"bg-green-100 text-green-800":t.status==="late"?"bg-yellow-100 text-yellow-800":t.status==="leave"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:t.status})})]},t.date))})]})})]})]})}),Ee&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Edit Teacher: ",n.full_name]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:y.full_name,onChange:t=>C({...y,full_name:t.target.value}),className:"w-full px-3 py-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{type:"email",value:y.email,onChange:t=>C({...y,email:t.target.value}),className:"w-full px-3 py-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{type:"text",value:y.phone,onChange:t=>C({...y,phone:t.target.value}),className:"w-full px-3 py-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:y.approval_status,onChange:t=>C({...y,approval_status:t.target.value}),className:"w-full px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:Xe,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Update"}),e.jsx("button",{onClick:()=>W(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})}),U&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Mark Daily Attendance: ",n.full_name]}),e.jsxs("div",{className:"mb-4 flex gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Month"}),e.jsx("select",{value:u,onChange:t=>{const s=parseInt(t.target.value);Pe(s),n&&A(n.id,s,h)},className:"px-3 py-2 border rounded-md",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(t=>e.jsx("option",{value:t,children:new Date(2e3,t-1).toLocaleString("default",{month:"long"})},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Year"}),e.jsx("input",{type:"number",value:h,onChange:t=>{const s=parseInt(t.target.value);Le(s),n&&A(n.id,u,s)},className:"px-3 py-2 border rounded-md w-24",min:"2000",max:"2100"})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Days"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:k.totalDays})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Present Days"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:k.presentDays})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Absent Days"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:k.absentDays})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["ðŸ’¡ By default, all days are marked as ",e.jsx("strong",{children:"Present"}),". Click on a day to toggle it to ",e.jsx("strong",{children:"Absent"}),"."]}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>e.jsx("div",{className:"text-center text-sm font-semibold text-gray-600 py-2",children:t},t)),(()=>{const t=new Date(h,u-1,1),a=new Date(h,u,0).getDate(),i=t.getDay(),c=[];for(let r=0;r<i;r++)c.push(e.jsx("div",{className:"p-2"},`empty-${r}`));for(let r=1;r<=a;r++){const f=new Date(h,u-1,r).toISOString().split("T")[0],N=de[f]||"present",S=f===new Date().toISOString().split("T")[0];c.push(e.jsxs("button",{onClick:()=>at(f),className:`p-2 border-2 rounded-lg transition ${N==="absent"?"bg-red-100 border-red-500 text-red-800 font-semibold":"bg-green-50 border-green-300 text-green-800 hover:bg-green-100"} ${S?"ring-2 ring-blue-500":""}`,title:`${r} ${new Date(h,u-1).toLocaleString("default",{month:"long"})} - Click to toggle`,children:[e.jsx("div",{className:"text-xs font-medium",children:r}),e.jsx("div",{className:"text-xs mt-1",children:N==="absent"?"âŒ":"âœ…"})]},r))}return c})()]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:nt,disabled:K,className:`flex-1 px-4 py-2 rounded-lg ${K?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:K?"Saving...":"Save Attendance"}),e.jsx("button",{onClick:()=>{le(!1),m(null)},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Close"})]})]})}),He&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:e.jsx("div",{className:"w-full max-w-2xl max-h-[90vh] bg-white rounded-2xl shadow-xl flex flex-col",children:e.jsxs("form",{onSubmit:lt,className:"flex flex-col flex-1 min-h-0",children:[e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto flex-1",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add New Staff Member"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",required:!0,value:d.full_name,onChange:t=>b({...d,full_name:t.target.value}),className:"w-full px-3 py-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role *"}),e.jsxs("select",{value:d.role,onChange:t=>b({...d,role:t.target.value}),className:"w-full px-3 py-2 border rounded-md",required:!0,children:[e.jsx("option",{value:"teacher",children:"Teacher"}),e.jsx("option",{value:"clerk",children:"Clerk"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:d.email,onChange:t=>b({...d,email:t.target.value}),className:"w-full px-3 py-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Password *"}),e.jsx("input",{type:"password",required:!0,minLength:8,value:d.password,onChange:t=>b({...d,password:t.target.value}),className:"w-full px-3 py-2 border rounded-md",placeholder:"Minimum 8 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:d.phone,onChange:t=>b({...d,phone:t.target.value}),className:"w-full px-3 py-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gender"}),e.jsxs("select",{value:d.gender,onChange:t=>b({...d,gender:t.target.value}),className:"w-full px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),d.role==="teacher"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Salary Start Date (Optional)"}),e.jsx("input",{type:"date",value:d.salary_start_date,onChange:t=>b({...d,salary_start_date:t.target.value}),className:"w-full px-3 py-2 border rounded-md"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Specify when the salary should start. This date will be used when setting the salary structure."})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-white border-t p-4 flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{ee(!1),b({email:"",password:"",full_name:"",role:"teacher",phone:"",gender:"",salary_start_date:""})},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Add Staff"})]})]})})}),Ve&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Attendance Assignment: ",n.full_name]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Assign teacher to mark attendance for a class. This is separate from teaching assignments. Teacher can mark day-wise attendance for this class."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Class *"}),e.jsxs("select",{value:g.class_group_id,onChange:t=>{Z({...g,class_group_id:t.target.value,section_id:""}),t.target.value&&z(t.target.value)},className:"w-full px-3 py-2 border rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Class"}),ae.map(t=>{const s=t.classifications&&t.classifications.length>0?` (${t.classifications.map(a=>`${a.type}: ${a.value}`).join(", ")})`:"";return e.jsxs("option",{value:t.id,children:[t.name,s]},t.id)})]})]}),g.class_group_id&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Section (Optional)"}),e.jsxs("select",{value:g.section_id,onChange:t=>Z({...g,section_id:t.target.value}),className:"w-full px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"",children:"No Section (All Sections)"}),(ne[g.class_group_id]||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"If no section is selected, teacher can mark attendance for all sections of this class."})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:tt,className:"flex-1 bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700",children:"Assign Attendance"}),e.jsx("button",{onClick:()=>{X(!1),m(null)},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})}),Fe&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg p-6 max-w-7xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(kt,{teacherId:n.id,teacherName:n.full_name||void 0,onClose:()=>{ce(!1),m(null)},showHeader:!0})})}),ie&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:n?`All Assignments: ${n.full_name}`:"All Teacher Assignments"}),e.jsx("button",{onClick:()=>{Q(!1),m(null),T(),M()},className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3 text-blue-600",children:"ðŸ“š Teaching Assignments"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Teachers assigned to teach specific subjects in classes."}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Teacher"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Section"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Subject"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Assigned"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(n?he:Y).map(t=>{var s,a,i,c,r;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:((s=t.teacher)==null?void 0:s.full_name)||(n==null?void 0:n.full_name)||"N/A"}),e.jsx("td",{className:"px-4 py-2 text-sm",children:((a=t.class_groups)==null?void 0:a.name)||"N/A"}),e.jsx("td",{className:"px-4 py-2 text-sm",children:((i=t.sections)==null?void 0:i.name)||"-"}),e.jsxs("td",{className:"px-4 py-2 text-sm",children:[((c=t.subjects)==null?void 0:c.name)||"N/A"," ",(r=t.subjects)!=null&&r.code?`(${t.subjects.code})`:""]}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-2 text-sm",children:e.jsx("button",{onClick:()=>st(t.id),className:"text-red-600 hover:text-red-900",children:"ðŸ—‘ï¸ Remove"})})]},t.id)})})]}),(n?he:Y).length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No teaching assignments found."})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-3 text-teal-600",children:"ðŸ“… Attendance Assignments"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Teachers assigned to mark day-wise attendance for classes. Independent of teaching assignments."}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Teacher"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Section"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Assigned"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(n?R.filter(t=>t.teacher_id===n.id):R).map(t=>{var s,a,i;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:((s=t.teacher)==null?void 0:s.full_name)||(n==null?void 0:n.full_name)||"N/A"}),e.jsx("td",{className:"px-4 py-2 text-sm",children:((a=t.class_group)==null?void 0:a.name)||"N/A"}),e.jsx("td",{className:"px-4 py-2 text-sm",children:((i=t.section)==null?void 0:i.name)||"All Sections"}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-2 text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-2 text-sm",children:e.jsx("button",{onClick:async()=>{var c;if(confirm("Are you sure you want to remove this attendance assignment?"))try{const r=(c=(await o.auth.getSession()).data.session)==null?void 0:c.access_token;if(!r)return;await gt(r,t.id),alert("Attendance assignment removed successfully!"),M(),n&&te(n)}catch(r){alert(r.message||"Failed to remove assignment")}},className:"text-red-600 hover:text-red-900",children:"ðŸ—‘ï¸ Remove"})})]},t.id)})})]}),(n?R.filter(t=>t.teacher_id===n.id):R).length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No attendance assignments found."})]})]})]})})]})}export{Et as default};
