import{r as d,s as L,j as e}from"./index-Dbd-PJY-.js";import{a as Ze,b as et,c as tt,d as st,e as at}from"./clerk.service-DZBhWzw-.js";function dt(){var pe,ge,ye,be,fe,je,Ne,ve,_e,we,Ce,Fe,ke,Pe,Se,Ae,$e,De,Te;const[N,$]=d.useState([]),[w,ee]=d.useState([]),[te,Re]=d.useState(0),[f,se]=d.useState(""),[y,Ee]=d.useState(""),[P,Ie]=d.useState([]),[o,Be]=d.useState(null),[r,Q]=d.useState(null),[b,W]=d.useState([]),[He,ae]=d.useState(!1),[nt,ne]=d.useState(!1),[D,R]=d.useState(!1),[E,I]=d.useState(!1),[p,k]=d.useState([]),[B,A]=d.useState("class-fee"),[l,v]=d.useState({payment_amount:"",payment_date:new Date().toISOString().split("T")[0],payment_mode:"cash",transaction_id:"",cheque_number:"",bank_name:"",notes:""}),[le,re]=d.useState(!1),[x,oe]=d.useState(null),[Oe,de]=d.useState(!1),[Ue,G]=d.useState(!1),[J,ie]=d.useState([]),[ze,ce]=d.useState(!1),H=d.useRef(0);d.useEffect(()=>{Ve()},[]),d.useEffect(()=>{Ye()},[y]);const C=d.useMemo(()=>p.length===0?[]:b.flatMap(t=>t.components||[]).filter(t=>p.includes(t.id)),[p,b]),_=d.useMemo(()=>C.reduce((t,s)=>t+s.pending_amount,0),[C]);d.useEffect(()=>{E&&p.length>0&&_>0?v(t=>({...t,payment_amount:_.toFixed(2)})):E&&p.length===0&&v(t=>({...t,payment_amount:""}))},[p.length,E,_]);const Ve=async()=>{var t;ne(!0);try{const s=(t=(await L.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;const n=(await Ze(s)).classes||[];console.log("[FeeCollection] Loaded classes:",n.map(c=>({id:c.id,name:c.name}))),Ie(n)}catch(s){console.error("Error loading classes:",s)}finally{ne(!1)}},Ye=async()=>{var s,a,n,c;const t=++H.current;R(!0);try{const m=(s=(await L.auth.getSession()).data.session)==null?void 0:s.access_token;if(!m){R(!1);return}const i=await et(m,y||void 0,1,50);if(t!==H.current){console.log("[FeeCollection] Ignoring stale request result"),R(!1);return}console.log("[FeeCollection] Received data:",{classesCount:((a=i.classes)==null?void 0:a.length)||0,unassignedCount:((n=i.unassigned)==null?void 0:n.length)||0,selectedClass:y,searchQuery:f,total_students:i.total_students,pagination:i.pagination,fullResponse:i});let g=[];if(i.classes&&Array.isArray(i.classes)?(console.log(`[FeeCollection] Processing ${i.classes.length} classes`),i.classes.forEach(u=>{var F;console.log(`[FeeCollection] Processing class: ${u.name} (id: ${u.id}), students: ${((F=u.students)==null?void 0:F.length)||0}`),u.students&&Array.isArray(u.students)?(console.log(`[FeeCollection] Class ${u.name} has ${u.students.length} students`),u.students.forEach(S=>{var q;const M=((q=S.profile)==null?void 0:q.full_name)||"Unknown";console.log(`[FeeCollection] Adding student: ${M} (id: ${S.id}, roll: ${S.roll_number})`),g.push({id:S.id,name:M,roll_number:S.roll_number||"N/A",class:u.name||"N/A",class_group_id:u.id})})):console.warn(`[FeeCollection] Class ${u.name} has no students array or it's not an array:`,u)})):console.warn("[FeeCollection] No classes array in response or it's not an array:",i.classes),!y&&i.unassigned&&Array.isArray(i.unassigned)&&i.unassigned.forEach(u=>{var F;g.push({id:u.id,name:((F=u.profile)==null?void 0:F.full_name)||"Unknown",roll_number:u.roll_number||"N/A",class:"Unassigned",class_group_id:void 0})}),console.log(`[FeeCollection] Extracted ${g.length} students from response`),t===H.current){ee(g);const u=i.total_students||((c=i.pagination)==null?void 0:c.total)||0;Re(u),console.log(`[FeeCollection] Updated allStudents with ${g.length} students (total from API: ${u})`),f.trim()||(console.log(`[FeeCollection] No search query, setting ${g.length} students immediately`),$(g))}}catch(m){if(console.error("Error loading students:",m),w.length===0&&N.length===0){const i=(m==null?void 0:m.message)||"Failed to load students";console.error("[FeeCollection] API Error:",i)}}finally{t===H.current&&R(!1)}},Qe=(t,s)=>{if(!s.trim()){console.log(`[FeeCollection] No search query, setting all ${t.length} students`),$(t);return}const a=s.toLowerCase().trim(),n=t.filter(c=>{const m=(c.name||"").toLowerCase(),i=(c.roll_number||"").toLowerCase(),g=m.startsWith(a),u=m.includes(a),F=i.includes(a);return g||u||F});console.log(`[FeeCollection] Filtered ${n.length} students from ${t.length} with query "${s}"`),$(n)};d.useEffect(()=>{if(D){console.log("[FeeCollection] Debounced effect skipped - loading students");return}if(w.length===0){console.log("[FeeCollection] Debounced effect skipped - no students available"),f.trim()||$([]);return}console.log(`[FeeCollection] Debounced effect triggered - allStudents: ${w.length}, searchQuery: "${f}"`);const t=setTimeout(()=>{!D&&w.length>0?(console.log(`[FeeCollection] Debounced effect executing - filtering ${w.length} students`),Qe(w,f)):console.log("[FeeCollection] Debounced effect cancelled - loading or no students")},150);return()=>clearTimeout(t)},[f,w,D]);const me=async t=>{var s;ae(!0);try{const a=(s=(await L.auth.getSession()).data.session)==null?void 0:s.access_token;if(!a)return;try{const n=await at(a,t);n.message&&n.message==="No fee configured for this student"?(Q(null),W([])):(Q(n.fee_structure),W(n.monthly_ledger||[]))}catch(n){n.message&&n.message.includes("No fee configured")?(Q(null),W([])):alert(n.message||"Failed to load fee data")}}catch(a){console.error("Error loading fee data:",a),alert("Error loading fee data")}finally{ae(!1)}},K=t=>{Be(t),me(t.id),k([]),G(!1)},We=async()=>{var t;if(o){ce(!0);try{const s=(t=(await L.auth.getSession()).data.session)==null?void 0:t.access_token;if(!s)return;const a=await tt(s,o.id);ie(a.payments||[]),G(!0)}catch(s){console.error("Error loading payment history:",s)}finally{ce(!1)}}},O=(t,s)=>{const a=new Date,n=a.getFullYear(),c=a.getMonth()+1;return t>n||t===n&&s>c},xe=d.useCallback((t,s,a)=>{if(O(s,a)){alert("Cannot select future months for payment. Advance payments require Principal approval.");return}k(n=>n.includes(t)?n.filter(m=>m!==t):[...n,t])},[]),Ge=async t=>{var m,i,g,u,F,S,M,q,Me,qe;if(t.preventDefault(),p.length===0){alert("Please select at least one fee component");return}if(!o)return;const s=b.flatMap(j=>j.components||[]).filter(j=>p.includes(j.id)),a=s.reduce((j,h)=>j+h.pending_amount,0),n=parseFloat(l.payment_amount||"0");if(n<=0){alert("Payment amount must be greater than 0");return}if(n>a){alert(`Payment amount (â‚¹${n.toFixed(2)}) cannot exceed total pending amount (â‚¹${a.toFixed(2)})`);return}if(s.filter(j=>{const h=b.find(Z=>{var Le;return(Le=Z.components)==null?void 0:Le.some(Xe=>Xe.id===j.id)});return h?O(h.year||0,h.monthNumber||0):!1}).length>0){alert("Cannot record payment for future months. Advance payments require Principal approval. Please contact Principal to enable advance payments.");return}re(!0);try{const j=(m=(await L.auth.getSession()).data.session)==null?void 0:m.access_token;if(!j)return;const h=await st(j,{monthly_fee_component_ids:p,payment_amount:parseFloat(l.payment_amount),payment_date:l.payment_date,payment_mode:l.payment_mode,transaction_id:l.transaction_id||null,cheque_number:l.cheque_number||null,bank_name:l.bank_name||null,notes:l.notes||null}),Z={...h,payment:{...h.payment,amount_paid:((i=h.payment)==null?void 0:i.amount_paid)||((g=h.payment)==null?void 0:g.payment_amount)||parseFloat(l.payment_amount),payment_amount:((u=h.payment)==null?void 0:u.payment_amount)||parseFloat(l.payment_amount),payment_date:((F=h.payment)==null?void 0:F.payment_date)||l.payment_date,payment_mode:((S=h.payment)==null?void 0:S.payment_mode)||l.payment_mode,transaction_id:((M=h.payment)==null?void 0:M.transaction_id)||l.transaction_id,cheque_number:((q=h.payment)==null?void 0:q.cheque_number)||l.cheque_number,bank_name:((Me=h.payment)==null?void 0:Me.bank_name)||l.bank_name,notes:((qe=h.payment)==null?void 0:qe.notes)||l.notes},selectedComponents:C};oe(Z),de(!0),I(!1),o&&me(o.id),v({payment_amount:"",payment_date:new Date().toISOString().split("T")[0],payment_mode:"cash",transaction_id:"",cheque_number:"",bank_name:"",notes:""}),k([])}catch(j){console.error("Error processing payment:",j);const h=j.message||"Failed to process payment";alert(h),(h.includes("future months")||h.includes("Advance payments"))&&k([])}finally{re(!1)}},Je=t=>{switch(t){case"paid":return"bg-green-100 text-green-800";case"partially-paid":return"bg-yellow-100 text-yellow-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};b.flatMap(t=>(t.components||[]).filter(s=>s.fee_type==="class-fee")),b.flatMap(t=>(t.components||[]).filter(s=>s.fee_type==="transport-fee")),b.flatMap(t=>(t.components||[]).filter(s=>s.fee_type==="custom-fee"));const T=b.map(t=>({...t,components:(t.components||[]).filter(s=>s.fee_type===B)})).filter(t=>(t.components||[]).length>0),U=(()=>{var s,a,n,c;if(T.length===0)return null;const t=T[0].components[0];return{name:t.fee_name,amount:t.fee_amount,cycle:((s=r==null?void 0:r.class_fee)==null?void 0:s.billing_frequency)||((a=r==null?void 0:r.transport_fee)==null?void 0:a.billing_frequency)||((c=(n=r==null?void 0:r.custom_fees)==null?void 0:n[0])==null?void 0:c.billing_frequency)||"monthly"}})(),ue=d.useMemo(()=>{const t=new Set;return C.forEach(s=>{const a=b.find(n=>{var c;return(c=n.components)==null?void 0:c.some(m=>m.id===s.id)});a&&a.month!==void 0&&t.add(String(a.month))}),Array.from(t)},[C,b]),X=d.useMemo(()=>C.reduce((t,s)=>t+s.fee_amount,0),[C]),z=d.useMemo(()=>0,[]),V=d.useMemo(()=>C.reduce((t,s)=>(s.status==="overdue"&&s.due_date&&Math.floor((new Date().getTime()-new Date(s.due_date).getTime())/(1e3*60*60*24)),t),0),[C]),Y=d.useMemo(()=>0,[]),he=d.useMemo(()=>X+z+V-Y,[X,z,V,Y]),Ke=T.every(t=>(t.components||[]).every(s=>s.status==="paid"||s.pending_amount===0));return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-3xl font-bold",children:"Fee Collection"})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Search Student"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Filter by Class (Optional)"}),e.jsxs("select",{value:y,onChange:t=>{const s=t.target.value,a=P.find(n=>n.id===s);console.log(`[FeeCollection] Class filter changed to: ${s} (${(a==null?void 0:a.name)||"unknown"})`),console.log("[FeeCollection] Available classes:",P.map(n=>({id:n.id,name:n.name}))),Ee(s),se(""),ee([]),$([])},className:"w-full border border-gray-300 rounded-lg px-4 py-2",children:[e.jsx("option",{value:"",children:"All Classes"}),P.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Search by Name"}),e.jsx("input",{type:"text",placeholder:y?`Search in ${((pe=P.find(t=>t.id===y))==null?void 0:pe.name)||"selected class"}...`:"Type student name (predictive search)...",value:f,onChange:t=>se(t.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-2"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:y?`Searching in ${((ge=P.find(t=>t.id===y))==null?void 0:ge.name)||"selected class"} - names starting with your input`:"Search shows students whose names start with your input"})]})]}),f&&e.jsx("div",{className:"border border-gray-200 rounded-lg max-h-64 overflow-y-auto",children:N.length===0?e.jsx("div",{className:"p-4 text-gray-500 text-center",children:f?e.jsxs("div",{children:[e.jsxs("p",{children:['No students found matching "',f,'"']}),y&&e.jsxs("p",{className:"text-xs mt-1",children:["in ",((ye=P.find(t=>t.id===y))==null?void 0:ye.name)||"selected class"]}),w.length>0&&e.jsxs("p",{className:"text-xs mt-1 text-gray-400",children:["Total students available: ",w.length]})]}):"Start typing to search for students"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-2 bg-gray-50 text-xs text-gray-600 border-b",children:["Found ",N.length," student",N.length!==1?"s":"",' matching "',f,'"',y&&` in ${((be=P.find(t=>t.id===y))==null?void 0:be.name)||"selected class"}`]}),N.slice(0,50).map(t=>e.jsxs("div",{onClick:()=>K(t),className:`p-4 border-b border-gray-200 cursor-pointer hover:bg-gray-50 transition ${(o==null?void 0:o.id)===t.id?"bg-blue-50 border-blue-300":""}`,children:[e.jsx("div",{className:"font-semibold text-gray-900",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Roll: ",t.roll_number," | Class: ",t.class]})]},t.id)),N.length>50&&e.jsx("div",{className:"p-4 text-center text-sm text-gray-500 bg-gray-50",children:"Showing first 50 results. Refine your search for more specific results."})]})}),!f&&y&&e.jsxs("div",{className:"border border-gray-200 rounded-lg max-h-64 overflow-y-auto",children:[e.jsxs("div",{className:"p-2 bg-gray-50 text-xs text-gray-600 border-b",children:["Showing ",N.length," of ",te||0," students in ",((fe=P.find(t=>t.id===y))==null?void 0:fe.name)||"selected class"]}),D?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading students..."}):N.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No students found in this class"}):N.slice(0,50).map(t=>e.jsxs("div",{onClick:()=>K(t),className:`p-4 border-b border-gray-200 cursor-pointer hover:bg-gray-50 transition ${(o==null?void 0:o.id)===t.id?"bg-blue-50 border-blue-300":""}`,children:[e.jsx("div",{className:"font-semibold text-gray-900",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Roll: ",t.roll_number," | Class: ",t.class]})]},t.id))]}),!f&&!y&&e.jsx("div",{className:"border border-gray-200 rounded-lg max-h-64 overflow-y-auto",children:D?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading students..."}):N.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:w.length===0?e.jsxs("div",{children:[e.jsx("p",{children:"No students found. Please check:"}),e.jsxs("ul",{className:"text-xs mt-2 text-left list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Are there active students in the system?"}),e.jsx("li",{children:"Is your authentication token valid?"}),e.jsx("li",{children:"Check browser console for API errors"})]})]}):e.jsxs("div",{children:[e.jsx("p",{children:"Start typing to search for students"}),e.jsx("p",{className:"text-xs mt-1 text-gray-400",children:"Or select a class to filter"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-2 bg-gray-50 text-xs text-gray-600 border-b",children:["Showing ",w.length," of ",te||0," students - Type to search or select a class to filter"]}),N.slice(0,50).map(t=>e.jsxs("div",{onClick:()=>K(t),className:`p-4 border-b border-gray-200 cursor-pointer hover:bg-gray-50 transition ${(o==null?void 0:o.id)===t.id?"bg-blue-50 border-blue-300":""}`,children:[e.jsx("div",{className:"font-semibold text-gray-900",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Roll: ",t.roll_number," | Class: ",t.class]})]},t.id)),N.length>50&&e.jsx("div",{className:"p-4 text-center text-sm text-gray-500 bg-gray-50",children:"Showing first 50 students. Use search or class filter to narrow down results."})]})})]}),o&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:o.name}),e.jsxs("p",{className:"text-gray-600",children:["Roll: ",o.roll_number," | Class: ",o.class]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:We,className:"px-4 py-2 rounded-lg font-semibold bg-green-600 text-white hover:bg-green-700",children:"View Payment History"}),e.jsxs("button",{onClick:()=>{I(!0),A("class-fee")},disabled:p.length===0,className:`px-4 py-2 rounded-lg font-semibold ${p.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:["Collect Payment (",p.length,")"]})]})]}),He?e.jsx("div",{className:"text-center py-8",children:"Loading fee data..."}):r===null?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"text-yellow-800 font-semibold text-lg",children:"âš ï¸ No fee configured for this student"}),e.jsx("p",{className:"text-yellow-700 mt-2",children:"Please contact Principal to assign fee structure."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Assigned Fee Structure"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(r==null?void 0:r.class_fee)&&e.jsxs("div",{className:"bg-white rounded p-3",children:[e.jsx("div",{className:"font-semibold text-blue-700",children:"Class Fee"}),e.jsxs("div",{children:["â‚¹",r.class_fee.amount.toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-600",children:r.class_fee.billing_frequency})]}),(r==null?void 0:r.transport_fee)&&e.jsxs("div",{className:"bg-white rounded p-3",children:[e.jsx("div",{className:"font-semibold text-blue-700",children:"Transport Fee"}),e.jsxs("div",{children:["â‚¹",r.transport_fee.amount.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[r.transport_fee.route_name," | ",r.transport_fee.billing_frequency]})]}),(r==null?void 0:r.custom_fees)&&r.custom_fees.length>0&&e.jsxs("div",{className:"bg-white rounded p-3",children:[e.jsxs("div",{className:"font-semibold text-blue-700",children:["Custom Fees (",r.custom_fees.length,")"]}),r.custom_fees.map((t,s)=>e.jsxs("div",{className:"text-xs",children:[t.category_name,": â‚¹",t.amount.toFixed(2)," (",t.billing_frequency,")"]},s))]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Monthly Fee Status Ledger"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Month"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Fee Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Fee Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Paid Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Pending Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Due Date"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase border-b",children:"Select"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[b.map((t,s)=>(t.components||[]).map((a,n)=>{const c=a.status==="overdue"||a.due_date&&new Date(a.due_date)<new Date&&a.status!=="paid",m=O(t.year||0,t.monthNumber||0),i=a.status==="paid"||a.pending_amount===0||m,g=a.status==="paid"?"bg-green-50":c?"bg-red-50":a.status==="partially-paid"?"bg-yellow-50":"bg-white";return e.jsxs("tr",{className:`${g} ${c?"border-l-4 border-red-500":""} ${m?"opacity-60":""}`,children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:n===0?t.month:""}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700",children:[e.jsx("div",{className:"font-medium",children:a.fee_name}),e.jsx("div",{className:"text-xs text-gray-500 capitalize",children:a.fee_type.replace("-"," ")})]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700",children:["â‚¹",a.fee_amount.toFixed(2)]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:e.jsxs("span",{className:a.paid_amount>0?"text-green-600 font-semibold":"",children:["â‚¹",a.paid_amount.toFixed(2)]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:e.jsxs("span",{className:a.pending_amount>0?"text-red-600 font-semibold":"text-gray-500",children:["â‚¹",a.pending_amount.toFixed(2)]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${Je(a.status)}`,children:a.status==="paid"?"ðŸŸ¢ PAID":c?"ðŸ”´ OVERDUE":a.status==="partially-paid"?"ðŸŸ¡ PARTIALLY PAID":m?"ðŸ”µ FUTURE":"âšª PENDING"})}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-600",children:[a.due_date?new Date(a.due_date).toLocaleDateString():"N/A",c&&a.due_date&&e.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[Math.floor((new Date().getTime()-new Date(a.due_date).getTime())/(1e3*60*60*24))," days overdue"]}),m&&e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Future month"})]}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:p.includes(a.id),onChange:()=>xe(a.id,t.year||0,t.monthNumber||0),disabled:i,title:m?"Future months require Principal approval":a.status==="paid"?"Already paid":a.pending_amount===0?"No pending amount":"",className:"w-5 h-5 cursor-pointer disabled:cursor-not-allowed"})})]},`${s}-${n}`)})),b.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No fee data available for this student"})}),b.length>0&&b.every(t=>(t.components||[]).length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No fee components found"})})]})]})}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 border border-green-300 rounded"}),e.jsx("span",{children:"Paid"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded"}),e.jsx("span",{children:"Partially Paid"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-100 border border-red-300 rounded"}),e.jsx("span",{children:"Pending/Overdue"})]})]})]})]})]}),E&&o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-[95vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Collect Fee"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[o.name," Â· ",o.class]})]}),e.jsx("button",{onClick:()=>{I(!1),k([]),A("class-fee")},className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"Ã—"})]}),e.jsx("div",{className:"p-4 border-b bg-white",children:e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[e.jsxs("div",{className:"flex gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Student:"}),e.jsx("span",{className:"font-semibold ml-2",children:o.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Class:"}),e.jsx("span",{className:"font-semibold ml-2",children:o.class})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Roll No:"}),e.jsx("span",{className:"font-semibold ml-2",children:o.roll_number})]})]}),e.jsxs("div",{className:"flex gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Pending:"}),e.jsxs("span",{className:`font-bold ml-2 ${_>0?"text-red-600":"text-green-600"}`,children:["â‚¹",_.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Transport:"}),e.jsx("span",{className:"font-semibold ml-2",children:r!=null&&r.transport_fee?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:"font-semibold ml-2 text-green-600",children:"Active"})]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex gap-2 mb-6 border-b",children:[(r==null?void 0:r.class_fee)&&e.jsx("button",{onClick:()=>{A("class-fee"),k([])},className:`px-4 py-2 font-semibold border-b-2 transition ${B==="class-fee"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:"Class Fee"}),(r==null?void 0:r.transport_fee)&&e.jsx("button",{onClick:()=>{A("transport-fee"),k([])},className:`px-4 py-2 font-semibold border-b-2 transition ${B==="transport-fee"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:"Transport Fee"}),(r==null?void 0:r.custom_fees)&&r.custom_fees.length>0&&e.jsxs("button",{onClick:()=>{A("custom-fee"),k([])},className:`px-4 py-2 font-semibold border-b-2 transition ${B==="custom-fee"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800"}`,children:["Custom Fees (",r.custom_fees.length,")"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[U&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-blue-900",children:[U.name," â€“ ",U.cycle]}),e.jsxs("div",{className:"text-sm text-blue-700",children:["Per Month: â‚¹",U.amount.toFixed(2)]})]}),Ke?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-green-800 font-semibold text-lg",children:"âœ… All months paid for this category"}),e.jsx("p",{className:"text-green-700 mt-2",children:"No pending fees available."})]}):T.length===0?e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No fee data available for this category"})}):e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Month"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Select"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:T.map(t=>(t.components||[]).map((s,a)=>{const n=s.status==="overdue"||s.due_date&&new Date(s.due_date)<new Date&&s.status!=="paid",c=O(t.year||0,t.monthNumber||0),m=s.status==="paid"||s.pending_amount===0||c,i=s.status==="paid"?"text-green-600":n?"text-red-600":s.status==="partially-paid"?"text-yellow-600":"text-gray-600",g=s.status==="paid"?"ðŸŸ¢":n?"ðŸ”´":s.status==="partially-paid"?"ðŸŸ¡":"âšª";return e.jsxs("tr",{className:`hover:bg-gray-50 ${s.status==="paid"?"bg-green-50":n?"bg-red-50":""}`,children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:a===0?t.month:""}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:i,children:[g," ",s.status==="paid"?"Paid":n?"Overdue":s.status==="partially-paid"?"Partially Paid":"Pending"]})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold",children:["â‚¹",s.fee_amount.toFixed(2)]}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:p.includes(s.id),onChange:()=>xe(s.id,t.year||0,t.monthNumber||0),disabled:m,className:"w-5 h-5 cursor-pointer disabled:cursor-not-allowed"})})]},`${t.year}-${t.monthNumber}-${a}`)}))})]})})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 sticky top-4",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Payment Summary"}),p.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Select months to collect payment"}):e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Selected Months:"}),e.jsx("div",{className:"mt-1 font-medium",children:ue.length>0?ue.join(", "):"None"})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Base Fee Total:"}),e.jsxs("span",{className:"font-semibold",children:["â‚¹",X.toFixed(2)]})]}),z>0&&e.jsxs("div",{className:"flex justify-between mb-2 text-orange-600",children:[e.jsx("span",{children:"Previous Balance:"}),e.jsxs("span",{children:["â‚¹",z.toFixed(2)]})]}),V>0&&e.jsxs("div",{className:"flex justify-between mb-2 text-red-600",children:[e.jsx("span",{children:"Late Fee / Fine:"}),e.jsxs("span",{children:["â‚¹",V.toFixed(2)]})]}),Y>0&&e.jsxs("div",{className:"flex justify-between mb-2 text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-â‚¹",Y.toFixed(2)]})]}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Final Amount:"}),e.jsxs("span",{className:"font-bold text-lg text-blue-600",children:["â‚¹",he.toFixed(2)]})]})})]}),parseFloat(l.payment_amount||"0")<he&&parseFloat(l.payment_amount||"0")>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 text-xs text-yellow-800",children:"âš ï¸ This will mark selected months as Partially Paid"})]})]})})]}),p.length>0&&e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Payment Details"}),e.jsxs("form",{onSubmit:Ge,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Payment Mode *"}),e.jsxs("select",{value:l.payment_mode,onChange:t=>v({...l,payment_mode:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"upi",children:"UPI"}),e.jsx("option",{value:"online",children:"Online"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"cheque",children:"Cheque"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Payment Amount *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:_,value:l.payment_amount||(p.length>0?_.toFixed(2):""),onChange:t=>{v({...l,payment_amount:t.target.value})},onBlur:t=>{const s=t.target.value,a=parseFloat(s);s&&(a<0||a>_)&&v({...l,payment_amount:_.toFixed(2)})},className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0}),e.jsxs("p",{className:`text-xs mt-1 ${parseFloat(l.payment_amount||"0")>_?"text-red-600 font-semibold":"text-gray-500"}`,children:["Max: â‚¹",_.toFixed(2)," (Total Pending) ",p.length===0&&"- Select months first"]}),parseFloat(l.payment_amount||"0")>_&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"âš ï¸ Payment amount cannot exceed total pending amount"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Payment Date *"}),e.jsx("input",{type:"date",value:l.payment_date,onChange:t=>v({...l,payment_date:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0})]}),(l.payment_mode==="upi"||l.payment_mode==="online"||l.payment_mode==="card")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Transaction ID"}),e.jsx("input",{type:"text",value:l.transaction_id,onChange:t=>v({...l,transaction_id:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter transaction ID"})]}),l.payment_mode==="cheque"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Cheque Number"}),e.jsx("input",{type:"text",value:l.cheque_number,onChange:t=>v({...l,cheque_number:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter cheque number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",value:l.bank_name,onChange:t=>v({...l,bank_name:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter bank name"})]})]}),l.payment_mode==="bank_transfer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",value:l.bank_name,onChange:t=>v({...l,bank_name:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter bank name"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:l.notes,onChange:t=>v({...l,notes:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",rows:2,placeholder:"Additional notes..."})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-6 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{I(!1),k([]),A("class-fee")},className:"px-6 py-2 text-gray-700 hover:text-gray-900 font-medium",children:"Cancel"}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{type:"submit",disabled:le||p.length===0,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-semibold",children:le?"Processing...":"Save & Print Receipt"})})]})]})]})]})]})}),Oe&&x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Payment Receipt"}),e.jsx("button",{onClick:()=>{window.print()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Print"}),e.jsx("button",{onClick:()=>{de(!1),oe(null)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Close"})]}),e.jsxs("div",{className:"border-2 border-gray-300 rounded-lg p-8 space-y-6 print:border-0",children:[e.jsxs("div",{className:"text-center border-b-2 border-gray-400 pb-4",children:[e.jsx("h4",{className:"text-3xl font-bold mb-2",children:"FEE PAYMENT RECEIPT"}),e.jsxs("div",{className:"space-y-1 text-gray-700",children:[e.jsxs("p",{className:"font-semibold",children:["Receipt No: ",x.receipt_number||((je=x.payment)==null?void 0:je.receipt_number)]}),e.jsxs("p",{children:["Date: ",new Date(((Ne=x.payment)==null?void 0:Ne.payment_date)||x.payment_date||new Date).toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-700 mb-1",children:"Student Name:"}),e.jsx("div",{className:"text-lg",children:o==null?void 0:o.name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-700 mb-1",children:"Roll Number:"}),e.jsx("div",{className:"text-lg",children:o==null?void 0:o.roll_number})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-700 mb-1",children:"Class:"}),e.jsx("div",{className:"text-lg",children:o==null?void 0:o.class})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-700 mb-1",children:"Payment Mode:"}),e.jsx("div",{className:"text-lg uppercase",children:((ve=x.payment)==null?void 0:ve.payment_mode)||"CASH"})]})]}),e.jsxs("div",{className:"border-t border-b border-gray-300 py-4",children:[e.jsx("h5",{className:"font-semibold mb-3 text-gray-700",children:"Payment Details:"}),e.jsx("div",{className:"space-y-2",children:(x.selectedComponents||C).map((t,s)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t.fee_name}),e.jsxs("span",{className:"font-semibold",children:["â‚¹",t.pending_amount.toFixed(2)]})]},s))})]}),(((_e=x.payment)==null?void 0:_e.transaction_id)||((we=x.payment)==null?void 0:we.cheque_number)||((Ce=x.payment)==null?void 0:Ce.bank_name))&&e.jsxs("div",{className:"border-b border-gray-300 pb-4",children:[e.jsx("h5",{className:"font-semibold mb-2 text-gray-700",children:"Transaction Details:"}),((Fe=x.payment)==null?void 0:Fe.transaction_id)&&e.jsxs("div",{className:"text-sm",children:["Transaction ID: ",x.payment.transaction_id]}),((ke=x.payment)==null?void 0:ke.cheque_number)&&e.jsxs("div",{className:"text-sm",children:["Cheque Number: ",x.payment.cheque_number]}),((Pe=x.payment)==null?void 0:Pe.bank_name)&&e.jsxs("div",{className:"text-sm",children:["Bank: ",x.payment.bank_name]})]}),e.jsx("div",{className:"border-t-2 border-gray-400 pt-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Total Amount Paid:"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["â‚¹",((Ae=(Se=x.payment)==null?void 0:Se.amount_paid)==null?void 0:Ae.toFixed(2))||((De=($e=x.payment)==null?void 0:$e.payment_amount)==null?void 0:De.toFixed(2))||(typeof x.payment_amount=="number"?x.payment_amount.toFixed(2):"0.00")]})]})}),((Te=x.payment)==null?void 0:Te.notes)&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-700 mb-1",children:"Notes:"}),e.jsx("div",{className:"text-sm text-gray-600",children:x.payment.notes})]}),x.message&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg text-sm text-blue-800",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Note:"}),x.message]}),e.jsxs("div",{className:"border-t border-gray-300 pt-4 mt-8 text-center text-xs text-gray-500",children:[e.jsx("p",{children:"This is a computer-generated receipt."}),e.jsx("p",{className:"mt-2",children:"Collected by: Clerk"})]})]})]})}),Ue&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-2xl font-bold",children:["Payment History - ",o==null?void 0:o.name]}),e.jsx("button",{onClick:()=>{G(!1),ie([])},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Close"})]}),ze?e.jsx("div",{className:"text-center py-8",children:"Loading payment history..."}):J.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No payment records found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Fee Component"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Period"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Mode"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Receipt No"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase border-b",children:"Collected By"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:J.map((t,s)=>{var a,n,c,m,i,g;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(t.payment_date).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[e.jsx("div",{className:"font-medium",children:((a=t.monthly_fee_components)==null?void 0:a.fee_name)||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500 capitalize",children:((c=(n=t.monthly_fee_components)==null?void 0:n.fee_type)==null?void 0:c.replace("-"," "))||""})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:(m=t.monthly_fee_components)!=null&&m.period_month&&((i=t.monthly_fee_components)!=null&&i.period_year)?`${new Date(2e3,t.monthly_fee_components.period_month-1).toLocaleString("default",{month:"short"})} ${t.monthly_fee_components.period_year}`:"N/A"}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["â‚¹",parseFloat(t.payment_amount||0).toFixed(2)]}),e.jsx("td",{className:"px-4 py-3 text-sm uppercase text-gray-600",children:t.payment_mode}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.receipt_number||"N/A"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:((g=t.received_by_profile)==null?void 0:g.full_name)||"Clerk"})]},s)})}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"px-4 py-3 text-sm font-semibold text-right",children:"Total Payments:"}),e.jsxs("td",{className:"px-4 py-3 text-sm font-bold text-green-600",children:["â‚¹",J.reduce((t,s)=>t+parseFloat(s.payment_amount||0),0).toFixed(2)]}),e.jsx("td",{colSpan:3})]})})]})})]})})]})}export{dt as default};
